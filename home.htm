<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Apps</title>
<link href="https://ok1static.oktacdn.com/assets/css/widgets/chosen.css" type="text/css" rel="stylesheet" />
<link href="https://ok1static.oktacdn.com/assets/css/widgets/jquery.qtip.css" type="text/css" rel="stylesheet" />
<link href="https://ok1static.oktacdn.com/assets/css/enduser/enduser.css" type="text/css" rel="stylesheet" />
</head>
<body>
<br>
<div id="app"></div>
<script>
var init = {credentials: "include"}; // For this work, enable CORS in Okta: Security > API > Trusted Origins > Add Origin > CORS.
// var init = {mode: "cors"}; // This didn't seem to work.
fetch(`${baseUrl}/api/v1/users/me/appLinks`, init)
.then(response => response.json())
.then(links => {
    var html = "<ul>";
    links.sort((link1, link2) => link1.sortOrder < link2.sortOrder ? -1 : 1)
    .forEach(link => html += `<li class='app-button-wrapper'>` +
        `<a href='${link.linkUrl}' target='_blank' class='app-button'>` + 
        `<img src='${link.logoUrl}' class='logo' style='visibility: visible;'/></a>` +
        `<p class='app-button-name'>${link.label}`);
    html += "</ul>";
    document.getElementById("app").innerHTML = `<a href="${baseUrl}" data-se="home-link" class="h-nav-href">` +
        `<span class="inline-icon icon-home-light"></span><span class="home-link-text">Home</span></a>&nbsp;` +
        `<a id="signout" class="h-nav-href" style="cursor: pointer">Sign out</a><br><br>${html}`;
    document.getElementById("signout").onclick = () => location.href = "/login.htm";
}).catch(error => location.href = "/login.htm");
</script>
</body>
</html>
