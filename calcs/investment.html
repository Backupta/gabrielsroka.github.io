<!doctype html>
<html>
<head>
<title>Investment Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://code.jquery.com/jquery-git.js" type="text/javascript"></script>
<script type="text/javascript">
function update() {
    var age = $("#age").val() * 1;
    var savings = $("#savings").val() * 1;
    var monthlyContribution = $("#monthlyContribution").val() * 1;
    var returnPercent = $("#returnPercent").val() / 100;
    var annualExpenses = $("#annualExpenses").val() * 1;
    var safeWithdrawalRate = $("#safeWithdrawalRate").val() / 100;

    var balance = savings;
    var goal = annualExpenses / safeWithdrawalRate;
    var startingAge = age;

    var table = "";
    var message = "You did not reach your goal. Try changing the numbers.";

    for (var i = age; i < 100; i++) {
        balance = (balance + monthlyContribution * 12) * (1 + returnPercent);

        table += "<tr><td>" + age + 
            "<td>$" + Math.round(balance).toLocaleString();

        if (balance >= goal) {
            var yearsToRetirement = age - startingAge;
            message = "You should reach your goal of $" + Math.round(goal).toLocaleString() +
                " in " + yearsToRetirement + " years, by age " + age + ".";
            break;
        }

        age++;
    }

    $("#results").html(message + "<br><br><table><tr><th>Age<th>Balance" + table + "</table>");
}

$(function () {
    // TODO hide slider in IE because it doesn't work.
    update();
    $("input").blur(update);
    $("#age").blur(function () {
        $("#ageRange").val($(this).val());
    }).select();
    $("#ageRange").on("input", function () {
        $("#age").val($(this).val());
        update();
    });
});
</script>
<style type="text/css">
body {
    font-family: 'Source Sans Pro', sans-serif;
    font-size: 11pt;
    background-color: white;
}

table {
    border-collapse: collapse;
}

td, th {
    border: 1px solid black;
    padding: 6px;
}
td,input {
    text-align: right;
}
input {
    width: 75px;
}
</style>
</head>
<body>
See <a href="https://chrisreining.com" target=_top>https://chrisreining.com</a><br><br>
<table>
<!-- maybe use sliders type=range instead of/in addition to these. -->
<tr><td>Age</td><td><input id=age value=50>&nbsp;&nbsp;&nbsp;</td><td><input id=ageRange type=range value=50></td></tr>
<tr><td>Savings</td><td>$<input id=savings value=100000>&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>Monthly Contribution</td><td>$<input id=monthlyContribution value=1500>&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>Return</td><td><input id=returnPercent value=7>%</td></tr>
<tr><td>Annual Expenses</td><td>$<input id=annualExpenses value=75000>&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>Safe Withdrawal Rate</td><td><input id=safeWithdrawalRate value=4>%</td></tr>
</table>
<br>
<div id=results></div>
</body>
</html>
